<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Check-In System</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter Font -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc;
        }
    </style>
    <!-- Load html5-qrcode library for scanning -->
    <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div id="app" class="w-full max-w-lg bg-white shadow-xl rounded-xl p-6 md:p-8">
        <h1 class="text-3xl font-bold text-gray-800 text-center mb-6">QR Code Check-In</h1>

        <!-- API URL Setup -->
        <div class="mb-6">
            <label for="appsScriptUrl" class="block text-sm font-medium text-gray-700 mb-2">
                Version 6
            </label>
            <input type="url" id="appsScriptUrl" placeholder="https://script.google.com/macros/s/..."
                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out"
                   value="https://script.google.com/macros/s/AKfycbwjZNW4bVOhKeqcEv_DHdhzN714qyg8C5J74MDyWfUbym99RaCkjg6JD9AZK_vucs_C/exec"
            >
            
        </div>

        <!-- Scanning Area -->
        <div id="scanner-container" class="border-4 border-dashed border-gray-300 rounded-xl p-4 mb-6 transition-all duration-300" style="min-height: 250px;">
            <div id="reader" style="width: 100%;"></div>
        </div>

        <!-- Status and Results -->
        <div id="status-area" class="text-center">
            <p id="message" class="text-lg text-gray-600 font-semibold">Ready to scan...</p>
        </div>

        <!-- Submission Success/Error Indicator -->
        <div id="result-indicator" class="mt-6 hidden transition-opacity duration-500">
            <div class="flex flex-col items-center">
                <!-- SVG Green Tick (Success) -->
                <svg id="success-icon" class="w-24 h-24 text-green-500 hidden animate-bounce" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <!-- SVG Red X (Error) -->
                <svg id="error-icon" class="w-24 h-24 text-red-500 hidden animate-bounce" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <button id="reset-button" class="mt-4 px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition duration-200 focus:outline-none focus:ring-4 focus:ring-blue-500/50">
                    Scan New QR
                </button>
            </div>
        </div>

    </div>

    <script>
        const app = document.getElementById('app');
        const readerId = 'reader';
        const appsScriptUrlInput = document.getElementById('appsScriptUrl');
        const messageDisplay = document.getElementById('message');
        const resultIndicator = document.getElementById('result-indicator');
        const successIcon = document.getElementById('success-icon');
        const errorIcon = document.getElementById('error-icon');
        const resetButton = document.getElementById('reset-button');
        const urlStatus = document.getElementById('url-status');
        let html5QrCode;

        /**
         * Converts a string to a URLSearchParams object for POST request.
         * @param {string} email The email address from the QR code.
         * @param {string} timestamp The current time string.
         * @returns {string} URL encoded string.
         */
        function createFormData(email, timestamp) {
            const params = new URLSearchParams();
            params.append('email', email);
            params.append('timestamp', timestamp);
            return params.toString();
        }

        /**
         * Displays the success state with the green tick.
         */
        function showSuccess(email) {
            messageDisplay.textContent = `Success! Recorded check-in for: ${email}`;
            successIcon.classList.remove('hidden');
            errorIcon.classList.add('hidden');
            resultIndicator.classList.remove('hidden');
            document.getElementById('scanner-container').classList.add('hidden');
        }

        function showNotFound(email) {
            messageDisplay.textContent = `Recorded not found for: ${email}`;
            errorIcon.classList.remove('hidden');
            successIcon.classList.add('hidden');
            resultIndicator.classList.remove('hidden');
            document.getElementById('scanner-container').classList.add('hidden');
        }

        /**
         * Displays the error state with the red X.
         */
        function showError(msg) {
            messageDisplay.textContent = msg;
            errorIcon.classList.remove('hidden');
            successIcon.classList.add('hidden');
            resultIndicator.classList.remove('hidden');
            document.getElementById('scanner-container').classList.add('hidden');
        }

        /**
         * Resets the application state to start scanning again.
         */
        function resetScanner() {
            // Clear result state
            resultIndicator.classList.add('hidden');
            successIcon.classList.add('hidden');
            errorIcon.classList.add('hidden');
            document.getElementById('scanner-container').classList.remove('hidden');
            messageDisplay.textContent = 'Ready to scan...';
            
            // Start the QR scanner
            startScanner();
        }

        /**
         * Handles the successful scan of a QR code.
         * @param {string} decodedText The content of the QR code (expected to be an email).
         */
        async function onScanSuccess(decodedText) {
            html5QrCode.stop().then(() => {
                // Scanner stopped successfully
            }).catch(err => {
                console.error("Failed to stop scanner: ", err);
            });

            const email = decodedText.trim();
            const appsScriptUrl = appsScriptUrlInput.value.trim();

            if (!appsScriptUrl.startsWith('http')) {
                showError('Error: Please enter a valid Google Apps Script Web App URL first.');
                return;
            }

            messageDisplay.textContent = `Scanned: ${email}. Submitting data...`;

            try {
                // Get current timestamp in a readable format
                const currentTime = new Date().toLocaleString();

                const formData = createFormData(email, currentTime);

                // --- API Call to Google Sheet via Apps Script ---
                const response = await fetch(appsScriptUrl, {
                    method: 'POST',
                    mode: 'no-cors', // Required for Google Apps Script Web App calls
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: formData,
                });

                const myArray = ["homartin@gmail.com", "homartin.ict@gmail.com","s25006@skhtst.edu.hk",
    "s25011@skhtst.edu.hk",
    "s25017@skhtst.edu.hk",
    "s25018@skhtst.edu.hk",
    "s25034@skhtst.edu.hk",
    "s25046@skhtst.edu.hk",
    "s25047@skhtst.edu.hk",
    "s25050@skhtst.edu.hk",
    "s25056@skhtst.edu.hk",
    "s25063@skhtst.edu.hk",
    "s25067@skhtst.edu.hk",
    "s25073@skhtst.edu.hk",
    "s25096@skhtst.edu.hk",
    "s25099@skhtst.edu.hk",
    "s25101@skhtst.edu.hk",
    "s25109@skhtst.edu.hk",
    "s25129@skhtst.edu.hk",
    "s25140@skhtst.edu.hk",
    "s25148@skhtst.edu.hk",
    "s25009@skhtst.edu.hk",
    "s25012@skhtst.edu.hk",
    "s25021@skhtst.edu.hk",

    // 1000 Generated Placeholder Emails
    "user1@fictionaldomain.com",
    "user2@fictionaldomain.com",
    "user3@fictionaldomain.com",
    "user4@fictionaldomain.com",
    "user5@fictionaldomain.com",
    "user6@fictionaldomain.com",
    "user7@fictionaldomain.com",
    "user8@fictionaldomain.com",
    "user9@fictionaldomain.com",
    "user10@fictionaldomain.com",
    "user11@fictionaldomain.com",
    "user12@fictionaldomain.com",
    "user13@fictionaldomain.com",
    "user14@fictionaldomain.com",
    "user15@fictionaldomain.com",
    "user16@fictionaldomain.com",
    "user17@fictionaldomain.com",
    "user18@fictionaldomain.com",
    "user19@fictionaldomain.com",
    "user20@fictionaldomain.com",
    "user21@fictionaldomain.com",
    "user22@fictionaldomain.com",
    "user23@fictionaldomain.com",
    "user24@fictionaldomain.com",
    "user25@fictionaldomain.com",
    "user26@fictionaldomain.com",
    "user27@fictionaldomain.com",
    "user28@fictionaldomain.com",
    "user29@fictionaldomain.com",
    "user30@fictionaldomain.com",
    "user31@fictionaldomain.com",
    "user32@fictionaldomain.com",
    "user33@fictionaldomain.com",
    "user34@fictionaldomain.com",
    "user35@fictionaldomain.com",
    "user36@fictionaldomain.com",
    "user37@fictionaldomain.com",
    "user38@fictionaldomain.com",
    "user39@fictionaldomain.com",
    "user40@fictionaldomain.com",
    "user41@fictionaldomain.com",
    "user42@fictionaldomain.com",
    "user43@fictionaldomain.com",
    "user44@fictionaldomain.com",
    "user45@fictionaldomain.com",
    "user46@fictionaldomain.com",
    "user47@fictionaldomain.com",
    "user48@fictionaldomain.com",
    "user49@fictionaldomain.com",
    "user50@fictionaldomain.com",
    "user51@fictionaldomain.com",
    "user52@fictionaldomain.com",
    "user53@fictionaldomain.com",
    "user54@fictionaldomain.com",
    "user55@fictionaldomain.com",
    "user56@fictionaldomain.com",
    "user57@fictionaldomain.com",
    "user58@fictionaldomain.com",
    "user59@fictionaldomain.com",
    "user60@fictionaldomain.com",
    "user61@fictionaldomain.com",
    "user62@fictionaldomain.com",
    "user63@fictionaldomain.com",
    "user64@fictionaldomain.com",
    "user65@fictionaldomain.com",
    "user66@fictionaldomain.com",
    "user67@fictionaldomain.com",
    "user68@fictionaldomain.com",
    "user69@fictionaldomain.com",
    "user70@fictionaldomain.com",
    "user71@fictionaldomain.com",
    "user72@fictionaldomain.com",
    "user73@fictionaldomain.com",
    "user74@fictionaldomain.com",
    "user75@fictionaldomain.com",
    "user76@fictionaldomain.com",
    "user77@fictionaldomain.com",
    "user78@fictionaldomain.com",
    "user79@fictionaldomain.com",
    "user80@fictionaldomain.com",
    "user81@fictionaldomain.com",
    "user82@fictionaldomain.com",
    "user83@fictionaldomain.com",
    "user84@fictionaldomain.com",
    "user85@fictionaldomain.com",
    "user86@fictionaldomain.com",
    "user87@fictionaldomain.com",
    "user88@fictionaldomain.com",
    "user89@fictionaldomain.com",
    "user90@fictionaldomain.com",
    "user91@fictionaldomain.com",
    "user92@fictionaldomain.com",
    "user93@fictionaldomain.com",
    "user94@fictionaldomain.com",
    "user95@fictionaldomain.com",
    "user96@fictionaldomain.com",
    "user97@fictionaldomain.com",
    "user98@fictionaldomain.com",
    "user99@fictionaldomain.com",
    "user100@fictionaldomain.com",
    "user101@fictionaldomain.com",
    "user102@fictionaldomain.com",
    "user103@fictionaldomain.com",
    "user104@fictionaldomain.com",
    "user105@fictionaldomain.com",
    "user106@fictionaldomain.com",
    "user107@fictionaldomain.com",
    "user108@fictionaldomain.com",
    "user109@fictionaldomain.com",
    "user110@fictionaldomain.com",
    "user111@fictionaldomain.com",
    "user112@fictionaldomain.com",
    "user113@fictionaldomain.com",
    "user114@fictionaldomain.com",
    "user115@fictionaldomain.com",
    "user116@fictionaldomain.com",
    "user117@fictionaldomain.com",
    "user118@fictionaldomain.com",
    "user119@fictionaldomain.com",
    "user120@fictionaldomain.com",
    "user121@fictionaldomain.com",
    "user122@fictionaldomain.com",
    "user123@fictionaldomain.com",
    "user124@fictionaldomain.com",
    "user125@fictionaldomain.com",
    "user126@fictionaldomain.com",
    "user127@fictionaldomain.com",
    "user128@fictionaldomain.com",
    "user129@fictionaldomain.com",
    "user130@fictionaldomain.com",
    "user131@fictionaldomain.com",
    "user132@fictionaldomain.com",
    "user133@fictionaldomain.com",
    "user134@fictionaldomain.com",
    "user135@fictionaldomain.com",
    "user136@fictionaldomain.com",
    "user137@fictionaldomain.com",
    "user138@fictionaldomain.com",
    "user139@fictionaldomain.com",
    "user140@fictionaldomain.com",
    "user141@fictionaldomain.com",
    "user142@fictionaldomain.com",
    "user143@fictionaldomain.com",
    "user144@fictionaldomain.com",
    "user145@fictionaldomain.com",
    "user146@fictionaldomain.com",
    "user147@fictionaldomain.com",
    "user148@fictionaldomain.com",
    "user149@fictionaldomain.com",
    "user150@fictionaldomain.com",
    "user151@fictionaldomain.com",
    "user152@fictionaldomain.com",
    "user153@fictionaldomain.com",
    "user154@fictionaldomain.com",
    "user155@fictionaldomain.com",
    "user156@fictionaldomain.com",
    "user157@fictionaldomain.com",
    "user158@fictionaldomain.com",
    "user159@fictionaldomain.com",
    "user160@fictionaldomain.com",
    "user161@fictionaldomain.com",
    "user162@fictionaldomain.com",
    "user163@fictionaldomain.com",
    "user164@fictionaldomain.com",
    "user165@fictionaldomain.com",
    "user166@fictionaldomain.com",
    "user167@fictionaldomain.com",
    "user168@fictionaldomain.com",
    "user169@fictionaldomain.com",
    "user170@fictionaldomain.com",
    "user171@fictionaldomain.com",
    "user172@fictionaldomain.com",
    "user173@fictionaldomain.com",
    "user174@fictionaldomain.com",
    "user175@fictionaldomain.com",
    "user176@fictionaldomain.com",
    "user177@fictionaldomain.com",
    "user178@fictionaldomain.com",
    "user179@fictionaldomain.com",
    "user180@fictionaldomain.com",
    "user181@fictionaldomain.com",
    "user182@fictionaldomain.com",
    "user183@fictionaldomain.com",
    "user184@fictionaldomain.com",
    "user185@fictionaldomain.com",
    "user186@fictionaldomain.com",
    "user187@fictionaldomain.com",
    "user188@fictionaldomain.com",
    "user189@fictionaldomain.com",
    "user190@fictionaldomain.com",
    "user191@fictionaldomain.com",
    "user192@fictionaldomain.com",
    "user193@fictionaldomain.com",
    "user194@fictionaldomain.com",
    "user195@fictionaldomain.com",
    "user196@fictionaldomain.com",
    "user197@fictionaldomain.com",
    "user198@fictionaldomain.com",
    "user199@fictionaldomain.com",
    "user200@fictionaldomain.com",
    "user201@fictionaldomain.com",
    "user202@fictionaldomain.com",
    "user203@fictionaldomain.com",
    "user204@fictionaldomain.com",
    "user205@fictionaldomain.com",
    "user206@fictionaldomain.com",
    "user207@fictionaldomain.com",
    "user208@fictionaldomain.com",
    "user209@fictionaldomain.com",
    "user210@fictionaldomain.com",
    "user211@fictionaldomain.com",
    "user212@fictionaldomain.com",
    "user213@fictionaldomain.com",
    "user214@fictionaldomain.com",
    "user215@fictionaldomain.com",
    "user216@fictionaldomain.com",
    "user217@fictionaldomain.com",
    "user218@fictionaldomain.com",
    "user219@fictionaldomain.com",
    "user220@fictionaldomain.com",
    "user221@fictionaldomain.com",
    "user222@fictionaldomain.com",
    "user223@fictionaldomain.com",
    "user224@fictionaldomain.com",
    "user225@fictionaldomain.com",
    "user226@fictionaldomain.com",
    "user227@fictionaldomain.com",
    "user228@fictionaldomain.com",
    "user229@fictionaldomain.com",
    "user230@fictionaldomain.com",
    "user231@fictionaldomain.com",
    "user232@fictionaldomain.com",
    "user233@fictionaldomain.com",
    "user234@fictionaldomain.com",
    "user235@fictionaldomain.com",
    "user236@fictionaldomain.com",
    "user237@fictionaldomain.com",
    "user238@fictionaldomain.com",
    "user239@fictionaldomain.com",
    "user240@fictionaldomain.com",
    "user241@fictionaldomain.com",
    "user242@fictionaldomain.com",
    "user243@fictionaldomain.com",
    "user244@fictionaldomain.com",
    "user245@fictionaldomain.com",
    "user246@fictionaldomain.com",
    "user247@fictionaldomain.com",
    "user248@fictionaldomain.com",
    "user249@fictionaldomain.com",
    "user250@fictionaldomain.com",
    "user251@fictionaldomain.com",
    "user252@fictionaldomain.com",
    "user253@fictionaldomain.com",
    "user254@fictionaldomain.com",
    "user255@fictionaldomain.com",
    "user256@fictionaldomain.com",
    "user257@fictionaldomain.com",
    "user258@fictionaldomain.com",
    "user259@fictionaldomain.com",
    "user260@fictionaldomain.com",
    "user261@fictionaldomain.com",
    "user262@fictionaldomain.com",
    "user263@fictionaldomain.com",
    "user264@fictionaldomain.com",
    "user265@fictionaldomain.com",
    "user266@fictionaldomain.com",
    "user267@fictionaldomain.com",
    "user268@fictionaldomain.com",
    "user269@fictionaldomain.com",
    "user270@fictionaldomain.com",
    "user271@fictionaldomain.com",
    "user272@fictionaldomain.com",
    "user273@fictionaldomain.com",
    "user274@fictionaldomain.com",
    "user275@fictionaldomain.com",
    "user276@fictionaldomain.com",
    "user277@fictionaldomain.com",
    "user278@fictionaldomain.com",
    "user279@fictionaldomain.com",
    "user280@fictionaldomain.com",
    "user281@fictionaldomain.com",
    "user282@fictionaldomain.com",
    "user283@fictionaldomain.com",
    "user284@fictionaldomain.com",
    "user285@fictionaldomain.com",
    "user286@fictionaldomain.com",
    "user287@fictionaldomain.com",
    "user288@fictionaldomain.com",
    "user289@fictionaldomain.com",
    "user290@fictionaldomain.com",
    "user291@fictionaldomain.com",
    "user292@fictionaldomain.com",
    "user293@fictionaldomain.com",
    "user294@fictionaldomain.com",
    "user295@fictionaldomain.com",
    "user296@fictionaldomain.com",
    "user297@fictionaldomain.com",
    "user298@fictionaldomain.com",
    "user299@fictionaldomain.com",
    "user300@fictionaldomain.com",
    "user301@fictionaldomain.com",
    "user302@fictionaldomain.com",
    "user303@fictionaldomain.com",
    "user304@fictionaldomain.com",
    "user305@fictionaldomain.com",
    "user306@fictionaldomain.com",
    "user307@fictionaldomain.com",
    "user308@fictionaldomain.com",
    "user309@fictionaldomain.com",
    "user310@fictionaldomain.com",
    "user311@fictionaldomain.com",
    "user312@fictionaldomain.com",
    "user313@fictionaldomain.com",
    "user314@fictionaldomain.com",
    "user315@fictionaldomain.com",
    "user316@fictionaldomain.com",
    "user317@fictionaldomain.com",
    "user318@fictionaldomain.com",
    "user319@fictionaldomain.com",
    "user320@fictionaldomain.com",
    "user321@fictionaldomain.com",
    "user322@fictionaldomain.com",
    "user323@fictionaldomain.com",
    "user324@fictionaldomain.com",
    "user325@fictionaldomain.com",
    "user326@fictionaldomain.com",
    "user327@fictionaldomain.com",
    "user328@fictionaldomain.com",
    "user329@fictionaldomain.com",
    "user330@fictionaldomain.com",
    "user331@fictionaldomain.com",
    "user332@fictionaldomain.com",
    "user333@fictionaldomain.com",
    "user334@fictionaldomain.com",
    "user335@fictionaldomain.com",
    "user336@fictionaldomain.com",
    "user337@fictionaldomain.com",
    "user338@fictionaldomain.com",
    "user339@fictionaldomain.com",
    "user340@fictionaldomain.com",
    "user341@fictionaldomain.com",
    "user342@fictionaldomain.com",
    "user343@fictionaldomain.com",
    "user344@fictionaldomain.com",
    "user345@fictionaldomain.com",
    "user346@fictionaldomain.com",
    "user347@fictionaldomain.com",
    "user348@fictionaldomain.com",
    "user349@fictionaldomain.com",
    "user350@fictionaldomain.com",
    "user351@fictionaldomain.com",
    "user352@fictionaldomain.com",
    "user353@fictionaldomain.com",
    "user354@fictionaldomain.com",
    "user355@fictionaldomain.com",
    "user356@fictionaldomain.com",
    "user357@fictionaldomain.com",
    "user358@fictionaldomain.com",
    "user359@fictionaldomain.com",
    "user360@fictionaldomain.com",
    "user361@fictionaldomain.com",
    "user362@fictionaldomain.com",
    "user363@fictionaldomain.com",
    "user364@fictionaldomain.com",
    "user365@fictionaldomain.com",
    "user366@fictionaldomain.com",
    "user367@fictionaldomain.com",
    "user368@fictionaldomain.com",
    "user369@fictionaldomain.com",
    "user370@fictionaldomain.com",
    "user371@fictionaldomain.com",
    "user372@fictionaldomain.com",
    "user373@fictionaldomain.com",
    "user374@fictionaldomain.com",
    "user375@fictionaldomain.com",
    "user376@fictionaldomain.com",
    "user377@fictionaldomain.com",
    "user378@fictionaldomain.com",
    "user379@fictionaldomain.com",
    "user380@fictionaldomain.com",
    "user381@fictionaldomain.com",
    "user382@fictionaldomain.com",
    "user383@fictionaldomain.com",
    "user384@fictionaldomain.com",
    "user385@fictionaldomain.com",
    "user386@fictionaldomain.com",
    "user387@fictionaldomain.com",
    "user388@fictionaldomain.com",
    "user389@fictionaldomain.com",
    "user390@fictionaldomain.com",
    "user391@fictionaldomain.com",
    "user392@fictionaldomain.com",
    "user393@fictionaldomain.com",
    "user394@fictionaldomain.com",
    "user395@fictionaldomain.com",
    "user396@fictionaldomain.com",
    "user397@fictionaldomain.com",
    "user398@fictionaldomain.com",
    "user399@fictionaldomain.com",
    "user400@fictionaldomain.com",
    "user401@fictionaldomain.com",
    "user402@fictionaldomain.com",
    "user403@fictionaldomain.com",
    "user404@fictionaldomain.com",
    "user405@fictionaldomain.com",
    "user406@fictionaldomain.com",
    "user407@fictionaldomain.com",
    "user408@fictionaldomain.com",
    "user409@fictionaldomain.com",
    "user410@fictionaldomain.com",
    "user411@fictionaldomain.com",
    "user412@fictionaldomain.com",
    "user413@fictionaldomain.com",
    "user414@fictionaldomain.com",
    "user415@fictionaldomain.com",
    "user416@fictionaldomain.com",
    "user417@fictionaldomain.com",
    "user418@fictionaldomain.com",
    "user419@fictionaldomain.com",
    "user420@fictionaldomain.com",
    "user421@fictionaldomain.com",
    "user422@fictionaldomain.com",
    "user423@fictionaldomain.com",
    "user424@fictionaldomain.com",
    "user425@fictionaldomain.com",
    "user426@fictionaldomain.com",
    "user427@fictionaldomain.com",
    "user428@fictionaldomain.com",
    "user429@fictionaldomain.com",
    "user430@fictionaldomain.com",
    "user431@fictionaldomain.com",
    "user432@fictionaldomain.com",
    "user433@fictionaldomain.com",
    "user434@fictionaldomain.com",
    "user435@fictionaldomain.com",
    "user436@fictionaldomain.com",
    "user437@fictionaldomain.com",
    "user438@fictionaldomain.com",
    "user439@fictionaldomain.com",
    "user440@fictionaldomain.com",
    "user441@fictionaldomain.com",
    "user442@fictionaldomain.com",
    "user443@fictionaldomain.com",
    "user444@fictionaldomain.com",
    "user445@fictionaldomain.com",
    "user446@fictionaldomain.com",
    "user447@fictionaldomain.com",
    "user448@fictionaldomain.com",
    "user449@fictionaldomain.com",
    "user450@fictionaldomain.com",
    "user451@fictionaldomain.com",
    "user452@fictionaldomain.com",
    "user453@fictionaldomain.com",
    "user454@fictionaldomain.com",
    "user455@fictionaldomain.com",
    "user456@fictionaldomain.com",
    "user457@fictionaldomain.com",
    "user458@fictionaldomain.com",
    "user459@fictionaldomain.com",
    "user460@fictionaldomain.com",
    "user461@fictionaldomain.com",
    "user462@fictionaldomain.com",
    "user463@fictionaldomain.com",
    "user464@fictionaldomain.com",
    "user465@fictionaldomain.com",
    "user466@fictionaldomain.com",
    "user467@fictionaldomain.com",
    "user468@fictionaldomain.com",
    "user469@fictionaldomain.com",
    "user470@fictionaldomain.com",
    "user471@fictionaldomain.com",
    "user472@fictionaldomain.com",
    "user473@fictionaldomain.com",
    "user474@fictionaldomain.com",
    "user475@fictionaldomain.com",
    "user476@fictionaldomain.com",
    "user477@fictionaldomain.com",
    "user478@fictionaldomain.com",
    "user479@fictionaldomain.com",
    "user480@fictionaldomain.com",
    "user481@fictionaldomain.com",
    "user482@fictionaldomain.com",
    "user483@fictionaldomain.com",
    "user484@fictionaldomain.com",
    "user485@fictionaldomain.com",
    "user486@fictionaldomain.com",
    "user487@fictionaldomain.com",
    "user488@fictionaldomain.com",
    "user489@fictionaldomain.com",
    "user490@fictionaldomain.com",
    "user491@fictionaldomain.com",
    "user492@fictionaldomain.com",
    "user493@fictionaldomain.com",
    "user494@fictionaldomain.com",
    "user495@fictionaldomain.com",
    "user496@fictionaldomain.com",
    "user497@fictionaldomain.com",
    "user498@fictionaldomain.com",
    "user499@fictionaldomain.com",
    "user500@fictionaldomain.com",
    "user501@fictionaldomain.com",
    "user502@fictionaldomain.com",
    "user503@fictionaldomain.com",
    "user504@fictionaldomain.com",
    "user505@fictionaldomain.com",
    "user506@fictionaldomain.com",
    "user507@fictionaldomain.com",
    "user508@fictionaldomain.com",
    "user509@fictionaldomain.com",
    "user510@fictionaldomain.com",
    "user511@fictionaldomain.com",
    "user512@fictionaldomain.com",
    "user513@fictionaldomain.com",
    "user514@fictionaldomain.com",
    "user515@fictionaldomain.com",
    "user516@fictionaldomain.com",
    "user517@fictionaldomain.com",
    "user518@fictionaldomain.com",
    "user519@fictionaldomain.com",
    "user520@fictionaldomain.com",
    "user521@fictionaldomain.com",
    "user522@fictionaldomain.com",
    "user523@fictionaldomain.com",
    "user524@fictionaldomain.com",
    "user525@fictionaldomain.com",
    "user526@fictionaldomain.com",
    "user527@fictionaldomain.com",
    "user528@fictionaldomain.com",
    "user529@fictionaldomain.com",
    "user530@fictionaldomain.com",
    "user531@fictionaldomain.com",
    "user532@fictionaldomain.com",
    "user533@fictionaldomain.com",
    "user534@fictionaldomain.com",
    "user535@fictionaldomain.com",
    "user536@fictionaldomain.com",
    "user537@fictionaldomain.com",
    "user538@fictionaldomain.com",
    "user539@fictionaldomain.com",
    "user540@fictionaldomain.com",
    "user541@fictionaldomain.com",
    "user542@fictionaldomain.com",
    "user543@fictionaldomain.com",
    "user544@fictionaldomain.com",
    "user545@fictionaldomain.com",
    "user546@fictionaldomain.com",
    "user547@fictionaldomain.com",
    "user548@fictionaldomain.com",
    "user549@fictionaldomain.com",
    "user550@fictionaldomain.com",
    "user551@fictionaldomain.com",
    "user552@fictionaldomain.com",
    "user553@fictionaldomain.com",
    "user554@fictionaldomain.com",
    "user555@fictionaldomain.com",
    "user556@fictionaldomain.com",
    "user557@fictionaldomain.com",
    "user558@fictionaldomain.com",
    "user559@fictionaldomain.com",
    "user560@fictionaldomain.com",
    "user561@fictionaldomain.com",
    "user562@fictionaldomain.com",
    "user563@fictionaldomain.com",
    "user564@fictionaldomain.com",
    "user565@fictionaldomain.com",
    "user566@fictionaldomain.com",
    "user567@fictionaldomain.com",
    "user568@fictionaldomain.com",
    "user569@fictionaldomain.com",
    "user570@fictionaldomain.com",
    "user571@fictionaldomain.com",
    "user572@fictionaldomain.com",
    "user573@fictionaldomain.com",
    "user574@fictionaldomain.com",
    "user575@fictionaldomain.com",
    "user576@fictionaldomain.com",
    "user577@fictionaldomain.com",
    "user578@fictionaldomain.com",
    "user579@fictionaldomain.com",
    "user580@fictionaldomain.com",
    "user581@fictionaldomain.com",
    "user582@fictionaldomain.com",
    "user583@fictionaldomain.com",
    "user584@fictionaldomain.com",
    "user585@fictionaldomain.com",
    "user586@fictionaldomain.com",
    "user587@fictionaldomain.com",
    "user588@fictionaldomain.com",
    "user589@fictionaldomain.com",
    "user590@fictionaldomain.com",
    "user591@fictionaldomain.com",
    "user592@fictionaldomain.com",
    "user593@fictionaldomain.com",
    "user594@fictionaldomain.com",
    "user595@fictionaldomain.com",
    "user596@fictionaldomain.com",
    "user597@fictionaldomain.com",
    "user598@fictionaldomain.com",
    "user599@fictionaldomain.com",
    "user600@fictionaldomain.com",
    "user601@fictionaldomain.com",
    "user602@fictionaldomain.com",
    "user603@fictionaldomain.com",
    "user604@fictionaldomain.com",
    "user605@fictionaldomain.com",
    "user606@fictionaldomain.com",
    "user607@fictionaldomain.com",
    "user608@fictionaldomain.com",
    "user609@fictionaldomain.com",
    "user610@fictionaldomain.com",
    "user611@fictionaldomain.com",
    "user612@fictionaldomain.com",
    "user613@fictionaldomain.com",
    "user614@fictionaldomain.com",
    "user615@fictionaldomain.com",
    "user616@fictionaldomain.com",
    "user617@fictionaldomain.com",
    "user618@fictionaldomain.com",
    "user619@fictionaldomain.com",
    "user620@fictionaldomain.com",
    "user621@fictionaldomain.com",
    "user622@fictionaldomain.com",
    "user623@fictionaldomain.com",
    "user624@fictionaldomain.com",
    "user625@fictionaldomain.com",
    "user626@fictionaldomain.com",
    "user627@fictionaldomain.com",
    "user628@fictionaldomain.com",
    "user629@fictionaldomain.com",
    "user630@fictionaldomain.com",
    "user631@fictionaldomain.com",
    "user632@fictionaldomain.com",
    "user633@fictionaldomain.com",
    "user634@fictionaldomain.com",
    "user635@fictionaldomain.com",
    "user636@fictionaldomain.com",
    "user637@fictionaldomain.com",
    "user638@fictionaldomain.com",
    "user639@fictionaldomain.com",
    "user640@fictionaldomain.com",
    "user641@fictionaldomain.com",
    "user642@fictionaldomain.com",
    "user643@fictionaldomain.com",
    "user644@fictionaldomain.com",
    "user645@fictionaldomain.com",
    "user646@fictionaldomain.com",
    "user647@fictionaldomain.com",
    "user648@fictionaldomain.com",
    "user649@fictionaldomain.com",
    "user650@fictionaldomain.com",
    "user651@fictionaldomain.com",
    "user652@fictionaldomain.com",
    "user653@fictionaldomain.com",
    "user654@fictionaldomain.com",
    "user655@fictionaldomain.com",
    "user656@fictionaldomain.com",
    "user657@fictionaldomain.com",
    "user658@fictionaldomain.com",
    "user659@fictionaldomain.com",
    "user660@fictionaldomain.com",
    "user661@fictionaldomain.com",
    "user662@fictionaldomain.com",
    "user663@fictionaldomain.com",
    "user664@fictionaldomain.com",
    "user665@fictionaldomain.com",
    "user666@fictionaldomain.com",
    "user667@fictionaldomain.com",
    "user668@fictionaldomain.com",
    "user669@fictionaldomain.com",
    "user670@fictionaldomain.com",
    "user671@fictionaldomain.com",
    "user672@fictionaldomain.com",
    "user673@fictionaldomain.com",
    "user674@fictionaldomain.com",
    "user675@fictionaldomain.com",
    "user676@fictionaldomain.com",
    "user677@fictionaldomain.com",
    "user678@fictionaldomain.com",
    "user679@fictionaldomain.com",
    "user680@fictionaldomain.com",
    "user681@fictionaldomain.com",
    "user682@fictionaldomain.com",
    "user683@fictionaldomain.com",
    "user684@fictionaldomain.com",
    "user685@fictionaldomain.com",
    "user686@fictionaldomain.com",
    "user687@fictionaldomain.com",
    "user688@fictionaldomain.com",
    "user689@fictionaldomain.com",
    "user690@fictionaldomain.com",
    "user691@fictionaldomain.com",
    "user692@fictionaldomain.com",
    "user693@fictionaldomain.com",
    "user694@fictionaldomain.com",
    "user695@fictionaldomain.com",
    "user696@fictionaldomain.com",
    "user697@fictionaldomain.com",
    "user698@fictionaldomain.com",
    "user699@fictionaldomain.com",
    "user700@fictionaldomain.com",
    "user701@fictionaldomain.com",
    "user702@fictionaldomain.com",
    "user703@fictionaldomain.com",
    "user704@fictionaldomain.com",
    "user705@fictionaldomain.com",
    "user706@fictionaldomain.com",
    "user707@fictionaldomain.com",
    "user708@fictionaldomain.com",
    "user709@fictionaldomain.com",
    "user710@fictionaldomain.com",
    "user711@fictionaldomain.com",
    "user712@fictionaldomain.com",
    "user713@fictionaldomain.com",
    "user714@fictionaldomain.com",
    "user715@fictionaldomain.com",
    "user716@fictionaldomain.com",
    "user717@fictionaldomain.com",
    "user718@fictionaldomain.com",
    "user719@fictionaldomain.com",
    "user720@fictionaldomain.com",
    "user721@fictionaldomain.com",
    "user722@fictionaldomain.com",
    "user723@fictionaldomain.com",
    "user724@fictionaldomain.com",
    "user725@fictionaldomain.com",
    "user726@fictionaldomain.com",
    "user727@fictionaldomain.com",
    "user728@fictionaldomain.com",
    "user729@fictionaldomain.com",
    "user730@fictionaldomain.com",
    "user731@fictionaldomain.com",
    "user732@fictionaldomain.com",
    "user733@fictionaldomain.com",
    "user734@fictionaldomain.com",
    "user735@fictionaldomain.com",
    "user736@fictionaldomain.com",
    "user737@fictionaldomain.com",
    "user738@fictionaldomain.com",
    "user739@fictionaldomain.com",
    "user740@fictionaldomain.com",
    "user741@fictionaldomain.com",
    "user742@fictionaldomain.com",
    "user743@fictionaldomain.com",
    "user744@fictionaldomain.com",
    "user745@fictionaldomain.com",
    "user746@fictionaldomain.com",
    "user747@fictionaldomain.com",
    "user748@fictionaldomain.com",
    "user749@fictionaldomain.com",
    "user750@fictionaldomain.com",
    "user751@fictionaldomain.com",
    "user752@fictionaldomain.com",
    "user753@fictionaldomain.com",
    "user754@fictionaldomain.com",
    "user755@fictionaldomain.com",
    "user756@fictionaldomain.com",
    "user757@fictionaldomain.com",
    "user758@fictionaldomain.com",
    "user759@fictionaldomain.com",
    "user760@fictionaldomain.com",
    "user761@fictionaldomain.com",
    "user762@fictionaldomain.com",
    "user763@fictionaldomain.com",
    "user764@fictionaldomain.com",
    "user765@fictionaldomain.com",
    "user766@fictionaldomain.com",
    "user767@fictionaldomain.com",
    "user768@fictionaldomain.com",
    "user769@fictionaldomain.com",
    "user770@fictionaldomain.com",
    "user771@fictionaldomain.com",
    "user772@fictionaldomain.com",
    "user773@fictionaldomain.com",
    "user774@fictionaldomain.com",
    "user775@fictionaldomain.com",
    "user776@fictionaldomain.com",
    "user777@fictionaldomain.com",
    "user778@fictionaldomain.com",
    "user779@fictionaldomain.com",
    "user780@fictionaldomain.com",
    "user781@fictionaldomain.com",
    "user782@fictionaldomain.com",
    "user783@fictionaldomain.com",
    "user784@fictionaldomain.com",
    "user785@fictionaldomain.com",
    "user786@fictionaldomain.com",
    "user787@fictionaldomain.com",
    "user788@fictionaldomain.com",
    "user789@fictionaldomain.com",
    "user790@fictionaldomain.com",
    "user791@fictionaldomain.com",
    "user792@fictionaldomain.com",
    "user793@fictionaldomain.com",
    "user794@fictionaldomain.com",
    "user795@fictionaldomain.com",
    "user796@fictionaldomain.com",
    "user797@fictionaldomain.com",
    "user798@fictionaldomain.com",
    "user799@fictionaldomain.com",
    "user800@fictionaldomain.com",
    "user801@fictionaldomain.com",
    "user802@fictionaldomain.com",
    "user803@fictionaldomain.com",
    "user804@fictionaldomain.com",
    "user805@fictionaldomain.com",
    "user806@fictionaldomain.com",
    "user807@fictionaldomain.com",
    "user808@fictionaldomain.com",
    "user809@fictionaldomain.com",
    "user810@fictionaldomain.com",
    "user811@fictionaldomain.com",
    "user812@fictionaldomain.com",
    "user813@fictionaldomain.com",
    "user814@fictionaldomain.com",
    "user815@fictionaldomain.com",
    "user816@fictionaldomain.com",
    "user817@fictionaldomain.com",
    "user818@fictionaldomain.com",
    "user819@fictionaldomain.com",
    "user820@fictionaldomain.com",
    "user821@fictionaldomain.com",
    "user822@fictionaldomain.com",
    "user823@fictionaldomain.com",
    "user824@fictionaldomain.com",
    "user825@fictionaldomain.com",
    "user826@fictionaldomain.com",
    "user827@fictionaldomain.com",
    "user828@fictionaldomain.com",
    "user829@fictionaldomain.com",
    "user830@fictionaldomain.com",
    "user831@fictionaldomain.com",
    "user832@fictionaldomain.com",
    "user833@fictionaldomain.com",
    "user834@fictionaldomain.com",
    "user835@fictionaldomain.com",
    "user836@fictionaldomain.com",
    "user837@fictionaldomain.com",
    "user838@fictionaldomain.com",
    "user839@fictionaldomain.com",
    "user840@fictionaldomain.com",
    "user841@fictionaldomain.com",
    "user842@fictionaldomain.com",
    "user843@fictionaldomain.com",
    "user844@fictionaldomain.com",
    "user845@fictionaldomain.com",
    "user846@fictionaldomain.com",
    "user847@fictionaldomain.com",
    "user848@fictionaldomain.com",
    "user849@fictionaldomain.com",
    "user850@fictionaldomain.com",
    "user851@fictionaldomain.com",
    "user852@fictionaldomain.com",
    "user853@fictionaldomain.com",
    "user854@fictionaldomain.com",
    "user855@fictionaldomain.com",
    "user856@fictionaldomain.com",
    "user857@fictionaldomain.com",
    "user858@fictionaldomain.com",
    "user859@fictionaldomain.com",
    "user860@fictionaldomain.com",
    "user861@fictionaldomain.com",
    "user862@fictionaldomain.com",
    "user863@fictionaldomain.com",
    "user864@fictionaldomain.com",
    "user865@fictionaldomain.com",
    "user866@fictionaldomain.com",
    "user867@fictionaldomain.com",
    "user868@fictionaldomain.com",
    "user869@fictionaldomain.com",
    "user870@fictionaldomain.com",
    "user871@fictionaldomain.com",
    "user872@fictionaldomain.com",
    "user873@fictionaldomain.com",
    "user874@fictionaldomain.com",
    "user875@fictionaldomain.com",
    "user876@fictionaldomain.com",
    "user877@fictionaldomain.com",
    "user878@fictionaldomain.com",
    "user879@fictionaldomain.com",
    "user880@fictionaldomain.com",
    "user881@fictionaldomain.com",
    "user882@fictionaldomain.com",
    "user883@fictionaldomain.com",
    "user884@fictionaldomain.com",
    "user885@fictionaldomain.com",
    "user886@fictionaldomain.com",
    "user887@fictionaldomain.com",
    "user888@fictionaldomain.com",
    "user889@fictionaldomain.com",
    "user890@fictionaldomain.com",
    "user891@fictionaldomain.com",
    "user892@fictionaldomain.com",
    "user893@fictionaldomain.com",
    "user894@fictionaldomain.com",
    "user895@fictionaldomain.com",
    "user896@fictionaldomain.com",
    "user897@fictionaldomain.com",
    "user898@fictionaldomain.com",
    "user899@fictionaldomain.com",
    "user900@fictionaldomain.com",
    "user901@fictionaldomain.com",
    "user902@fictionaldomain.com",
    "user903@fictionaldomain.com",
    "user904@fictionaldomain.com",
    "user905@fictionaldomain.com",
    "user906@fictionaldomain.com",
    "user907@fictionaldomain.com",
    "user908@fictionaldomain.com",
    "user909@fictionaldomain.com",
    "user910@fictionaldomain.com",
    "user911@fictionaldomain.com",
    "user912@fictionaldomain.com",
    "user913@fictionaldomain.com",
    "user914@fictionaldomain.com",
    "user915@fictionaldomain.com",
    "user916@fictionaldomain.com",
    "user917@fictionaldomain.com",
    "user918@fictionaldomain.com",
    "user919@fictionaldomain.com",
    "user920@fictionaldomain.com",
    "user921@fictionaldomain.com",
    "user922@fictionaldomain.com",
    "user923@fictionaldomain.com",
    "user924@fictionaldomain.com",
    "user925@fictionaldomain.com",
    "user926@fictionaldomain.com",
    "user927@fictionaldomain.com",
    "user928@fictionaldomain.com",
    "user929@fictionaldomain.com",
    "user930@fictionaldomain.com",
    "user931@fictionaldomain.com",
    "user932@fictionaldomain.com",
    "user933@fictionaldomain.com",
    "user934@fictionaldomain.com",
    "user935@fictionaldomain.com",
    "user936@fictionaldomain.com",
    "user937@fictionaldomain.com",
    "user938@fictionaldomain.com",
    "user939@fictionaldomain.com",
    "user940@fictionaldomain.com",
    "user941@fictionaldomain.com",
    "user942@fictionaldomain.com",
    "user943@fictionaldomain.com",
    "user944@fictionaldomain.com",
    "user945@fictionaldomain.com",
    "user946@fictionaldomain.com",
    "user947@fictionaldomain.com",
    "user948@fictionaldomain.com",
    "user949@fictionaldomain.com",
    "user950@fictionaldomain.com",
    "user951@fictionaldomain.com",
    "user952@fictionaldomain.com",
    "user953@fictionaldomain.com",
    "user954@fictionaldomain.com",
    "user955@fictionaldomain.com",
    "user956@fictionaldomain.com",
    "user957@fictionaldomain.com",
    "user958@fictionaldomain.com",
    "user959@fictionaldomain.com",
    "user960@fictionaldomain.com",
    "user961@fictionaldomain.com",
    "user962@fictionaldomain.com",
    "user963@fictionaldomain.com",
    "user964@fictionaldomain.com",
    "user965@fictionaldomain.com",
    "user966@fictionaldomain.com",
    "user967@fictionaldomain.com",
    "user968@fictionaldomain.com",
    "user969@fictionaldomain.com",
    "user970@fictionaldomain.com",
    "user971@fictionaldomain.com",
    "user972@fictionaldomain.com",
    "user973@fictionaldomain.com",
    "user974@fictionaldomain.com",
    "user975@fictionaldomain.com",
    "user976@fictionaldomain.com",
    "user977@fictionaldomain.com",
    "user978@fictionaldomain.com",
    "user979@fictionaldomain.com",
    "user980@fictionaldomain.com",
    "user981@fictionaldomain.com",
    "user982@fictionaldomain.com",
    "user983@fictionaldomain.com",
    "user984@fictionaldomain.com",
    "user985@fictionaldomain.com",
    "user986@fictionaldomain.com",
    "user987@fictionaldomain.com",
    "user988@fictionaldomain.com",
    "user989@fictionaldomain.com",
    "user990@fictionaldomain.com",
    "user991@fictionaldomain.com",
    "user992@fictionaldomain.com",
    "user993@fictionaldomain.com",
    "user994@fictionaldomain.com",
    "user995@fictionaldomain.com",
    "user996@fictionaldomain.com",
    "user997@fictionaldomain.com",
    "user998@fictionaldomain.com",
    "user999@fictionaldomain.com",
    "user1000@fictionaldomain.com"
  ];

                if (myArray.includes(email)) {
                    showSuccess(email);
                } else {
                    showNotFound(email);
                 }
                // Since we use 'no-cors' for Apps Script, we can't reliably read the response body or status.
                // If the fetch call succeeds without a network error, we assume the Apps Script ran successfully.
                // The Apps Script is designed to return a specific JSON success object, but 'no-cors' prevents us from checking it.
                // For a successful POST fetch (even with 'no-cors'), we show success.
                // showError(response.status);
                /*switch (response.result) {
                    case 'success':
                        showSuccess(email);
                        break;
                    case 'notfound':
                        showNotFound(email);
                        break;
                }*/

            } catch (error) {
                console.error("Submission failed:", error);
                showError(`Network Error: Could not reach the server. Check URL and connection.`);
            }
        }

        /**
         * Initializes and starts the QR code scanner.
         */
        function startScanner() {
            // Check if the HTML5 QR Code object is initialized, if not, create it.
            if (!html5QrCode) {
                html5QrCode = new Html5Qrcode(readerId);
            }
            
            // Configuration for the scanner
            const config = {
                fps: 10,
                qrbox: { width: 250, height: 250 },
                aspectRatio: 1.0,
                // prefer front camera if available
                facingMode: { ideal: "environment" } 
            };
            
            // Start scanning
            html5QrCode.start({ facingMode: "environment" }, config, onScanSuccess, (errorMessage) => {
                // Do not log minor scanning errors to keep console clean
            })
            .catch(err => {
                messageDisplay.textContent = 'Error: Could not start camera. Make sure you grant permissions.';
                console.error('Camera start error:', err);
                // Hide the scanner container if camera fails
                document.getElementById('scanner-container').classList.add('hidden');
            });
        }

        // --- Event Listeners and Initialization ---

        window.onload = () => {
            resetButton.addEventListener('click', resetScanner);
            appsScriptUrlInput.addEventListener('input', () => {
                if (appsScriptUrlInput.value.startsWith('http')) {
                    urlStatus.textContent = "URL accepted. Ready to scan!";
                    urlStatus.classList.remove('text-red-500');
                    urlStatus.classList.add('text-green-600');
                } else {
                    urlStatus.textContent = "(See 'apps_script_backend_instructions.md' for setup guide.)";
                    urlStatus.classList.remove('text-green-600');
                    urlStatus.classList.add('text-red-500');
                }
            });

            // Initial start of the scanner
            startScanner();
        };

    </script>
</body>
</html>
